<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus CaseX - Certificate Purpose Case</title>
    
    <!-- PDF Library CDNs - IMPORTANT: Keep these here in each HTML file -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        /* Base Styles */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            background-color: #f4f7f6;
        }

        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background-color: #004d80;
            color: white;
            padding: 15px 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        header h1 {
            margin: 0;
            font-size: 1.8em;
        }

        nav {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap; /* Allow nav items to wrap */
            justify-content: center;
            gap: 10px; /* Space between nav items */
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            font-weight: bold;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }

        nav a:hover {
            background-color: #0056b3;
            text-decoration: none;
        }

        main.case-sheet-container {
            flex-grow: 1; /* Allows main content to expand and push footer down */
            /* --- MODIFICATION FOR LARGER DESKTOP SIZE --- */
            width: 95vw; /* Make it take up 95% of the viewport width */
            /* max-width: 1200px;  -- Removed/Modified for full desktop size */
            margin: 20px auto; /* Center the container and add vertical space */
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .form-actions {
            display: flex;
            justify-content: flex-end; /* Align buttons to the right */
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .form-actions button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background-color: #004d80;
            color: white;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease;
        }

        .form-actions button:hover {
            background-color: #0056b3;
        }

        /* Fieldset Styling */
        fieldset.section {
            border: 1px solid #ced4da;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 25px;
            background-color: #f8f9fa;
        }

        fieldset.section legend {
            font-size: 1.2em;
            font-weight: bold;
            color: #004d80;
            padding: 0 10px;
            background-color: white; /* To make legend stand out */
            border-radius: 3px;
            margin-left: 10px;
        }

        /* Form Group Layout - Using Grid for main fieldset content */
        fieldset.section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Responsive 2-column or more */
            gap: 20px; /* Space between grid items (form groups) */
        }

        /* Specific overrides for sections that need full width or a different internal layout */
        .form-group {
            /* Base styling for all form groups */
            margin-bottom: 0; /* Managed by grid gap */
        }

        /* Ensure certain form groups (like textarea for HPI, PMH, etc.) span full width */
        .form-group:has(textarea[name="chiefComplaint"]),
        .form-group:has(textarea[name="hpi"]),
        .form-group:has(textarea[name="pmh"]),
        .form-group:has(textarea[name="systemicMedications"]),
        .form-group:has(textarea[name="ocularROS_details"]),
        .form-group:has(textarea[name="systemicROS_details"]),
        .form-group:has(textarea[name="visualFieldSpecifics"]),
        .form-group:has(textarea[name="visualFieldFindingsCertificate"]),
        .form-group:has(textarea[name="eomsCertificate"]),
        .form-group:has(textarea[name="refractionDetailsCertificate"]),
        .form-group:has(textarea[name="restrictionsEndorsements"]),
        .form-group:has(textarea[name="ocularHealthStatus"]),
        .form-group:has(textarea[name="certificateInvestigations"]),
        .form-group:has(textarea[name="assessmentDiagnoses"]),
        .form-group:has(textarea[name="plan"]),
        .form-group:has(textarea[name="prognosis"]),
        .form-group:has(textarea[name="internalNotes"]),
        .form-group:has(textarea[name="notesReflection"]) {
            grid-column: 1 / -1; /* Make these textareas span all columns */
        }

        /* Headings for VA */
        .va-label {
            grid-column: 1 / -1; /* Span full width */
            font-size: 1.1em;
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 5px;
            color: #004d80;
        }

        /* Flexbox for rows within grid sections (like VA) */
        .va-row {
            grid-column: 1 / -1; /* Span full width within the fieldset grid */
            display: flex;
            flex-wrap: wrap; /* Allow items to wrap on smaller screens */
            gap: 15px; /* Space between items in the row */
            margin-bottom: 10px; /* Space between flex rows */
            align-items: flex-end; /* Align items to the bottom of the row if they have different heights */
        }

        .va-item {
            flex: 1; /* Distribute space equally */
            min-width: 250px; /* Minimum width before wrapping */
        }

        /* Inline input groups (radio/checkbox) */
        .input-group-inline {
            display: flex;
            flex-wrap: wrap;
            gap: 15px; /* Space between inline options */
            margin-top: 5px;
            align-items: center;
        }
        .input-group-inline input[type="radio"],
        .input-group-inline input[type="checkbox"] {
            width: auto; /* Override 100% width */
            margin-right: 5px;
        }

        /* Conditional Group Styling */
        .conditional-group {
            margin-top: 10px;
            padding: 0 10px; /* Adjust padding for collapsed state */
            border-left: 3px solid #004d80;
            background-color: #e9f5ff;
            border-radius: 4px;
            transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out, padding 0.3s ease-in-out;
            max-height: 0; /* Start collapsed */
            overflow: hidden;
            opacity: 0;
            pointer-events: none; /* Prevent interaction when hidden */
            box-sizing: border-box; /* Ensure padding is included in max-height */
        }

        /* Use JavaScript to toggle aria-expanded="true" when condition is met */
        .conditional-group[aria-expanded="true"] {
            max-height: 150px; /* A sufficiently large value for textareas, adjust as needed */
            opacity: 1;
            pointer-events: auto;
            padding: 10px; /* Restore padding when expanded */
            margin-top: 10px; /* Restore margin when expanded */
        }

        /* Input Styles */
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
        }

        input[type="text"],
        input[type="number"],
        input[type="date"],
        input[type="tel"],
        input[type="email"],
        textarea,
        select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 1em;
            color: #495057;
            background-color: #fff;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        input:focus, textarea:focus, select:focus {
            border-color: #80bdff;
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        textarea {
            min-height: 40px; /* Default min-height for textareas */
            resize: vertical;
        }

        footer {
            background-color: #343a40;
            color: white;
            text-align: center;
            padding: 15px 20px;
            margin-top: auto; /* Pushes footer to the bottom */
            box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
        }

        footer p {
            margin: 5px 0;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            nav a {
                margin: 5px;
            }
            main.case-sheet-container {
                margin: 10px;
                padding: 15px;
                width: auto; /* Revert to auto width on small screens to fit content */
            }
            fieldset.section {
                grid-template-columns: 1fr; /* Stack columns on small screens */
            }
            .va-row {
                flex-direction: column; /* Stack items in rows on small screens */
                gap: 10px;
            }
            .va-item {
                min-width: unset; /* Allow full width */
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Focus CaseX - Certificate Purpose Case</h1>
        <nav>
            <a href="index.html">Back to Case Selection</a>
            <a href="general-case.html">General</a>
            <a href="certificate-case.html">Certificate</a>
            <a href="emergency-case.html">Emergency</a>
            <a href="followup-case.html">Follow-up</a>
            <a href="contactlens-case.html">Contact Lens</a>
            <a href="orthoptics-case.html">Orthoptics</a>
            <a href="lowvision-case.html">Low Vision</a>
            <a href="surgicalcomanagement-case.html">Surgical Co-management</a>
            <a href="pediatricoptometry-case.html">Pediatric Optometry</a>
            <a href="ocularsurfacedisease-case.html">Ocular Surface Disease</a>
            <a href="myopiamanagement-case.html">Myopia Management</a>
            <a href="neurooptometry-case.html">Neuro-Optometry & Rehab</a>
        </nav>
    </header>

    <main class="case-sheet-container">
        <form id="optometryCaseForm">
            <input type="hidden" name="caseType" value="certificate">

            <!-- MOVED FORM ACTIONS TO THE TOP -->
            <div class="form-actions form-actions-top">
                <button type="button" id="clearForm">Clear Form</button>
                <button type="submit" id="saveCase">Save Case</button>
                <button type="button" id="downloadPdf">Download PDF</button>
            </div>

            <fieldset class="section">
                <legend>Patient Info</legend>
                <div class="form-group">
                    <label for="patientId">Patient ID (Optional)</label>
                    <input type="text" id="patientId" name="patientId" placeholder="e.g., P00123" value="CERT-005-JD">
                </div>
                <div class="form-group">
                    <label for="patientName">Name <sup>*</sup></label>
                    <input type="text" id="patientName" name="patientName" placeholder="e.g., John Doe" required aria-required="true" autofocus value="Jane Doe">
                </div>
                <div class="form-group">
                    <label for="dateOfBirth">Date of Birth <sup>*</sup></label>
                    <input type="date" id="dateOfBirth" name="dateOfBirth" required aria-required="true" value="1985-05-15">
                </div>
                <div class="form-group">
                    <label for="dateOfExamination">Date of Examination <sup>*</sup></label>
                    <input type="date" id="dateOfExamination" name="dateOfExamination" required aria-required="true" value="2024-06-19"> <!-- Current Date -->
                </div>
                <div class="form-group">
                    <label for="certificateType">Specific Certificate Type <sup>*</sup></label>
                    <select id="certificateType" name="certificateType" required aria-required="true" aria-controls="certificateType_other">
                        <option value="">Select...</option>
                        <option value="Driving License (Private)" selected>Driving License (Private)</option>
                        <option value="Driving License (Commercial)">Driving License (Commercial)</option>
                        <option value="Pilot (FAA Class 1)">Pilot (FAA Class 1)</option>
                        <option value="Pilot (FAA Class 2)">Pilot (FAA Class 2)</option>
                        <option value="Pilot (FAA Class 3)">Pilot (FAA Class 3)</option>
                        <option value="Employment (General)">Employment (General)</option>
                        <option value="Employment (Specific: Police)">Employment (Specific: Police)</option>
                        <option value="Employment (Specific: Firefighter)">Employment (Specific: Firefighter)</option>
                        <option value="Other">Other (describe below)</option>
                    </select>
                    <input type="text" id="certificateType_other" name="certificateType_other" placeholder="Specify other certificate type" class="conditional-group" aria-expanded="false" aria-describedby="certificateType">
                </div>
                <div class="form-group">
                    <label for="governingBody">Governing Body/Authority</label>
                    <input type="text" id="governingBody" name="governingBody" placeholder="e.g., State DMV, FAA, Employer Name" value="Local Department of Motor Vehicles">
                </div>
                <div class="form-group">
                    <label for="dateOfLastCertificate">Date of Issuance of Last Certificate (if renewal)</label>
                    <input type="date" id="dateOfLastCertificate" name="dateOfLastCertificate" value="2022-06-19"> <!-- 2 years ago -->
                </div>
            </fieldset>

            <fieldset class="section">
                <legend>Chief Complaint (CC)</legend>
                <div class="form-group">
                    <label for="chiefComplaint">Chief Complaint <sup>*</sup></label>
                    <textarea id="chiefComplaint" name="chiefComplaint" rows="2" placeholder="e.g., Vision assessment for driving license renewal." required aria-required="true">Routine vision examination for renewal of private driving license.</textarea>
                </div>
                <div class="form-group">
                    <label for="hpi">History of Present Illness (HPI)</label>
                    <textarea id="hpi" name="hpi" rows="3" placeholder="Details about specific visual concerns related to certificate purpose.">Patient reports no new visual symptoms or changes since last examination. Wears spectacles daily. Comfortable with current vision. No history of ocular ocular trauma or surgery.</textarea>
                </div>
            </fieldset>

            <fieldset class="section">
                <legend>History</legend>
                <div class="form-group">
                    <label for="pmh">Past Medical History (PMH) relevant to vision</label>
                    <textarea id="pmh" name="pmh" rows="2" placeholder="e.g., Diabetes, Hypertension, Neurological conditions.">Controlled Type 2 Diabetes (diagnosed 5 years ago), Mild Hypertension.</textarea>
                </div>
                <div class="form-group">
                    <label for="systemicMedications">Systemic Medications (relevant to vision)</label>
                    <textarea id="systemicMedications" name="systemicMedications" rows="2" placeholder="e.g., medications with ocular side effects.">Metformin, Lisinopril.</textarea>
                </div>
                <div class="form-group">
                    <label>Ocular Review of Systems (ROS)</label>
                    <div class="input-group-inline">
                        <input type="radio" id="ocularROS_wnl" name="ocularROS_status" value="WNL" checked aria-controls="ocularROS_details">
                        <label for="ocularROS_wnl">WNL</label>
                        <input type="radio" id="ocularROS_notwnl" name="ocularROS_status" value="Not WNL" aria-controls="ocularROS_details">
                        <label for="ocularROS_notwnl">Not WNL (details below)</label>
                    </div>
                    <textarea id="ocularROS_details" name="ocularROS_details" rows="2" class="conditional-group" aria-expanded="false" aria-describedby="ocularROS_wnl ocularROS_notwnl"></textarea>
                </div>
                <div class="form-group">
                    <label>Systemic Review of Systems (ROS)</label>
                    <div class="input-group-inline">
                        <input type="radio" id="systemicROS_wnl" name="systemicROS_status" value="WNL" checked aria-controls="systemicROS_details">
                        <label for="systemicROS_wnl">WNL</label>
                        <input type="radio" id="systemicROS_notwnl" name="systemicROS_status" value="Not WNL" aria-controls="systemicROS_details">
                        <label for="systemicROS_notwnl">Not WNL (details below)</label>
                    </div>
                    <textarea id="systemicROS_details" name="systemicROS_details" rows="2" class="conditional-group" aria-expanded="false" aria-describedby="systemicROS_wnl systemicROS_notwnl"></textarea>
                </div>
                <div class="form-group">
                    <label>History of Diplopia (past/present)?</label>
                    <div class="input-group-inline">
                        <input type="radio" id="diplopiaHistoryYes" name="diplopiaHistory" value="Yes">
                        <label for="diplopiaHistoryYes">Yes</label>
                        <input type="radio" id="diplopiaHistoryNo" name="diplopiaHistory" value="No" checked>
                        <label for="diplopiaHistoryNo">No</label>
                    </div>
                </div>
            </fieldset>
            <fieldset class="section">
                <legend>Examination (Certificate Specific)</legend>

                <div class="va-label">Visual Acuity</div>
                <div class="va-row">
                    <div class="form-group va-item">
                        <label>UCVA OD</label>
                        <input type="text" name="vaUncorrectedOD" placeholder="e.g., 20/40 (6/12)" value="20/60 (6/18)">
                    </div>
                    <div class="form-group va-item">
                        <label>UCVA OS</label>
                        <input type="text" name="vaUncorrectedOS" placeholder="e.g., 20/50 (6/15)" value="20/80 (6/24)">
                    </div>
                    <div class="form-group va-item">
                        <label>UCVA OU</label>
                        <input type="text" name="vaUncorrectedOU" placeholder="e.g., 20/30 (6/9)" value="20/50 (6/15)">
                    </div>
                </div>
                <div class="va-row">
                    <div class="form-group va-item">
                        <label>BCVA OD (with habitual Rx)</label>
                        <input type="text" name="vaBestCorrectedHabitualOD" placeholder="e.g., 20/20 (6/6) with -2.00DS" value="20/20 (6/6) with -2.50DS">
                    </div>
                    <div class="form-group va-item">
                        <label>BCVA OS (with habitual Rx)</label>
                        <input type="text" name="vaBestCorrectedHabitualOS" placeholder="e.g., 20/25 (6/7.5) with -1.75DS" value="20/25 (6/7.5) with -2.75DS">
                    </div>
                     <div class="form-group va-item">
                        <label>BCVA OU (with habitual Rx)</label>
                        <input type="text" name="vaBestCorrectedHabitualOU" placeholder="e.g., 20/20 (6/6)" value="20/20 (6/6)">
                    </div>
                </div>
                <div class="va-row">
                    <div class="form-group va-item">
                        <label>BCVA OD (Best Corrected)</label>
                        <input type="text" name="vaBestCorrectedOD" placeholder="e.g., 20/20 (6/6)" value="20/20 (6/6)">
                    </div>
                    <div class="form-group va-item">
                        <label>BCVA OS (Best Corrected)</label>
                        <input type="text" name="vaBestCorrectedOS" placeholder="e.g., 20/20 (6/6)" value="20/20 (6/6)">
                    </div>
                     <div class="form-group va-item">
                        <label>BCVA OU (Best Corrected)</label>
                        <input type="text" name="vaBestCorrectedOU" placeholder="e.g., 20/20 (6/6)" value="20/20 (6/6)">
                    </div>
                </div>
                <div class="va-row">
                    <div class="form-group va-item">
                        <label>Near VA OD</label>
                        <input type="text" name="vaNearOD" placeholder="e.g., J2 / N5" value="J1 / N4">
                    </div>
                    <div class="form-group va-item">
                        <label>Near VA OS</label>
                        <input type="text" name="vaNearOS" placeholder="e.g., J3 / N6" value="J1 / N4">
                    </div>
                    <div class="form-group va-item">
                        <label>Near VA OU</label>
                        <input type="text" name="vaNearOU" placeholder="e.g., J2 / N5" value="J1 / N4">
                    </div>
                </div>
                <div class="va-row">
                    <div class="form-group va-item">
                        <label for="distanceVaLogMAROD">Distance VA OD (LogMAR)</label>
                        <input type="text" id="distanceVaLogMAROD" name="distanceVaLogMAROD" placeholder="e.g., 0.0 (LogMAR)" value="0.0">
                    </div>
                    <div class="form-group va-item">
                        <label for="distanceVaLogMAROS">Distance VA OS (LogMAR)</label>
                        <input type="text" id="distanceVaLogMAROS" name="distanceVaLogMAROS" placeholder="e.g., 0.1 (LogMAR)" value="0.1">
                    </div>
                </div>

                <div class="form-group">
                    <label for="colorVisionCertificate">Color Vision <sup>*</sup></label>
                    <select id="colorVisionCertificate" name="colorVisionCertificate" required aria-required="true" aria-controls="colorVisionCertificate_details">
                        <option value="">Select...</option>
                        <option value="Normal" selected>Normal</option>
                        <option value="Red-Green Deficiency">Red-Green Deficiency</option>
                        <option value="Blue-Yellow Deficiency">Blue-Yellow Deficiency</option>
                        <option value="Acquired Deficiency">Acquired Deficiency</option>
                        <option value="Not Tested">Not Tested</option>
                        <option value="Other">Other</option>
                    </select>
                    <input type="text" id="colorVisionCertificate_details" name="colorVisionCertificate_details" placeholder="e.g., Ishihara 14/14, Type of deficiency." class="conditional-group" aria-expanded="false" aria-describedby="colorVisionCertificate" value="Ishihara 14/14 plates correctly identified.">
                </div>
                <div class="form-group">
                    <label for="visualFieldSpecifics">Specific Visual Field Test (if required)</label>
                    <textarea id="visualFieldSpecifics" name="visualFieldSpecifics" rows="2" placeholder="e.g., Esterman Binocular Field Test.">Confrontation Fields performed.</textarea>
                </div>
                <div class="form-group">
                    <label for="visualFieldFindingsCertificate">Visual Field Findings <sup>*</sup></label>
                    <textarea id="visualFieldFindingsCertificate" name="visualFieldFindingsCertificate" rows="3" placeholder="e.g., Binocular field meets 120 degrees horizontal, 20 degrees vertical. No significant scotomas in central 20 degrees." required aria-required="true">Full to confrontation OU. No gross scotomas detected. Patient reports no visual field defects.</textarea>
                </div>
                <div class="form-group">
                    <label for="peripheralVisionHorizontal">Peripheral Vision (Horizontal - degrees)</label>
                    <input type="number" id="peripheralVisionHorizontal" name="peripheralVisionHorizontal" min="0" max="180" placeholder="e.g., 120" value="150">
                </div>
                <div class="form-group">
                    <label for="peripheralVisionVertical">Peripheral Vision (Vertical - degrees)</label>
                    <input type="number" id="peripheralVisionVertical" name="peripheralVisionVertical" min="0" max="120" placeholder="e.g., 90" value="100">
                </div>
                <div class="form-group">
                    <label for="eomsCertificate">Extraocular Motility (EOMs) / Diplopia <sup>*</sup></label>
                    <textarea id="eomsCertificate" name="eomsCertificate" rows="2" placeholder="e.g., Full range of motion, no diplopia in primary gaze or extremes." required aria-required="true">Full and smooth in all gazes, no diplopia reported or observed. No nystagmus.</textarea>
                </div>
                <div class="form-group">
                    <label for="glareSensitivity">Glare Sensitivity (Optional)</label>
                    <input type="text" id="glareSensitivity" name="glareSensitivity" placeholder="e.g., Normal with Brightness Acuity Tester (BAT)." value="Not tested, patient denies issues.">
                </div>
                <div class="form-group">
                    <label for="contrastSensitivity">Contrast Sensitivity (Optional)</label>
                    <input type="text" id="contrastSensitivity" name="contrastSensitivity" placeholder="e.g., Pelli-Robson chart: 1.80 log units." value="Not tested, patient denies issues.">
                </div>
                <div class="form-group">
                    <label for="darkAdaptation">Dark Adaptation (Optional)</label>
                    <input type="text" id="darkAdaptation" name="darkAdaptation" placeholder="e.g., WNL, Abnormal." value="Not tested, patient denies issues.">
                </div>
                <div class="form-group">
                    <label for="depthPerception">Depth Perception (seconds of arc)</label>
                    <input type="text" id="depthPerception" name="depthPerception" placeholder="e.g., 40 seconds of arc" value="40 seconds of arc (Stereo Fly Test)">
                </div>
                <div class="form-group">
                    <label for="refractionDetailsCertificate">Refraction Details (if relevant for Rx endorsement)</label>
                    <textarea id="refractionDetailsCertificate" name="refractionDetailsCertificate" rows="2" placeholder="e.g., Current Rx: OD: -2.00DS, OS: -2.25DS.">Current Spectacle Rx: OD: -2.50 DS, OS: -2.75 DS. Best corrected to 20/20 OU.</textarea>
                </div>
                <div class="form-group">
                    <label>Vision Correction Required/Allowed <sup>*</sup></label>
                    <select id="visionCorrectionRequired" name="visionCorrectionRequired" required aria-required="true">
                        <option value="">Select...</option>
                        <option value="Yes (Spectacles Only)" selected>Yes (Spectacles Only)</option>
                        <option value="Yes (Contact Lenses Only)">Yes (Contact Lenses Only)</option>
                        <option value="Yes (Either)">Yes (Either)</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="restrictionsEndorsements">Restrictions/Endorsements</label>
                    <textarea id="restrictionsEndorsements" name="restrictionsEndorsements" rows="2" placeholder="e.g., Must wear corrective lenses, Daylight driving only.">Must wear corrective lenses while driving.</textarea>
                </div>
                <div class="form-group">
                    <label for="ocularHealthStatus">General Ocular Health Status</label>
                    <textarea id="ocularHealthStatus" name="ocularHealthStatus" rows="2" placeholder="e.g., No progressive eye disease that would impair fitness for certificate.">Anterior and posterior segments appear healthy, stable, and show no progressive disease that would impair fitness for driving.</textarea>
                </div>
            </fieldset>

            <fieldset class="section">
                <legend>Investigations (if specific tests are required)</legend>
                <div class="form-group">
                    <label for="certificateInvestigations">Relevant Investigations</label>
                    <textarea id="certificateInvestigations" name="certificateInvestigations" rows="3" placeholder="e.g., Humphrey 30-2 performed.">No additional specific investigations required beyond routine optometric examination for this certificate type.</textarea>
                </div>
            </fieldset>

            <fieldset class="section">
                <legend>Assessment & Plan</legend>
                <div class="form-group">
                    <label for="assessmentDiagnoses">Assessment / Diagnoses <sup>*</sup></label>
                    <textarea id="assessmentDiagnoses" name="assessmentDiagnoses" rows="3" placeholder="e.g., 1. Myopia OU (corrected with spectacles).&#10;2. Visually fit for purpose." required aria-required="true">1. Myopia OU (H52.1)
2. Presbyopia OU (H52.4)
3. History of Controlled Type 2 Diabetes (E11.9)
4. Patient meets visual standards for private driving license.</textarea>
                </div>
                <div class="form-group">
                    <label for="meetsStandards">Patient meets visual standards for certificate? <sup>*</sup></label>
                    <select id="meetsStandards" name="meetsStandards" required aria-required="true">
                        <option value="">Select...</option>
                        <option value="Yes" selected>Yes</option>
                        <option value="No">No</option>
                        <option value="Conditional">Conditional</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="plan">Plan / Recommendations <sup>*</sup></label>
                    <textarea id="plan" name="plan" rows="5" placeholder="e.g., 1. Patient meets the visual standards for a Class B driving license as per [State/Country] regulations.&#10;2. Provided a copy of the completed vision certificate form to patient." required aria-required="true">1. Complete and sign the vision certificate form for private driving license renewal.
2. Advise patient to continue wearing prescribed spectacles for all driving activities.
3. Recommend annual eye examinations due to history of diabetes.
4. Provide patient with a copy of the completed certificate form.</textarea>
                </div>
                <div class="form-group">
                    <label for="prognosis">Prognosis</label>
                    <textarea id="prognosis" name="prognosis" rows="2" placeholder="e.g., Good with current management.">Good, visual status is stable and meets requirements for the certificate with corrective lenses.</textarea>
                </div>
            </fieldset>

            <fieldset class="section">
                <legend>Notes & Reflection</legend>
                <div class="form-group">
                    <label for="internalNotes">Internal Notes (Not for Patient)</label>
                    <textarea id="internalNotes" name="internalNotes" rows="2">Patient was cooperative. Discussed the importance of annual exams due to diabetic status, even though retinopathy is not currently observed.</textarea>
                </div>
                <div class="form-group">
                    <label for="notesReflection">Personal Reflection/Learning Points</label>
                    <textarea id="notesReflection" name="notesReflection" rows="3">This case was straightforward for a driving license renewal. It reinforced the importance of thoroughly documenting BCVA and visual field, even for routine certifications. Also, ensuring the correct restrictions are noted as per local regulations.</textarea>
                </div>
            </fieldset>

        </form>
    </main>

    <footer>
        <p>&copy; 2025 Focus CaseX. All rights reserved.</p>
        <p>Powered by Focus</p>
    </footer>

    <!-- Your main application script -->
    <script src="certificate_script.js"></script>
    <!-- The new PDF export handler script, loaded after main scripts and CDNs -->
    <script src="certificate_pdf-export-handler.js"></script> 
</body>
</html>